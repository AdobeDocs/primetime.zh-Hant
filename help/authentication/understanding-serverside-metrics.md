---
title: 瞭解伺服器端度量
description: 瞭解伺服器端度量
exl-id: 516884e9-6b0b-451a-b84a-6514f571aa44
source-git-commit: bfc3ba55c99daba561255760baf273b6538a3c6e
workflow-type: tm+mt
source-wordcount: '2187'
ht-degree: 0%

---

# 瞭解伺服器端度量 {#understanding-server-side-metrics}

>[!NOTE]
>
>此頁面上的內容僅供參考。 使用此API需要來自Adobe的當前許可證。 不允許未經授權使用。


## 導言 {#intro}

本文檔介紹由權利服務監控(ESM)服務生成的Adobe Primetime身份驗證伺服器端度量。 它描述的事件與從客戶端角度看的事件不同(程式設計師在其頁面/應用程式上是否實施Adobe Analytics等測量服務時會看到什麼)。  

## 事件摘要 {#events_summary}

從Adobe Primetime驗證伺服器端的角度生成以下事件：

* **驗證流中生成的事件**（使用MVPD的實際登錄）

   * AuthN嘗試的通知 — 當用戶被發送到MVPD登錄站點時，將生成此通知。
   * AuthN掛起通知 — 如果用戶成功使用其MVPD登錄，則當用戶重定向回黃金時段身份驗證時，將生成此通知。
   * 已授予AuthN的通知 — 當用戶返回程式設計師站點並已成功從黃金時段身份驗證檢索到身份驗證令牌時，將生成此通知。 
* **授權流** （僅使用MVPD檢查授權）\
   *先決條件：* 有效的AuthN令牌
   * AuthZ嘗試的通知
   * 已授予AuthZ通知
* **成功播放請求**\
   *先決條件：* 有效的AuthN和AuthZ令牌
   * 使用Adobe Primetime驗證通知支票 
   * 播放請求需要授權的驗證和授權


中詳細介紹了唯一用戶的數量 [唯一用戶](#unique-users) 的下界。 概括而言，由於通常快取已授予的身份驗證和授權響應，因此通常應用以下公式：

* AuthN嘗試次數\>授予的AuthN次數
* AuthZ嘗試次數\>授予的AuthZ次數
* AuthZ嘗試次數\>授予的AuthN次數（通常）
* 成功播放請求數\>已授予的AuthZ數


### 示例 {#example}

以下示例顯示了一個品牌一個月的伺服器端度量：

|度量 | MVPD 1 | MVPD 2 |.. | MVPD n |總計 | | - | - | - | - | - | - | |成功的身份驗證 | 1125 | 2892 | | 2203 | SUM(MVP1+..MVPD n) | |成功授權 | 2527 | 5603 | | 5904 | SUM(MVP1+..MVPD n) | |成功播放請求 | 4201 | 10518 | | 10737 | SUM(MVP1+..MVPD n) | |唯一用戶 | 1375 | 2400 | | 2890 |所有MVPD的所有用戶的SUM消除重複\* | |嘗試的身份驗證 | 2147 | 3887 | | 3108 | SUM(MVP1+..MVPD n) | |嘗試的授權 | 2889 | 6139 | | 6039 | SUM(MVP1+..MVPD n) |

</br>

在這種情況下，重複資料消除不應產生任何效果，因為不同的MVPD用戶不應接收相同的用戶ID。 當對兩個不同品牌但是同一MVPD進行總和時，重複資料消除效果應該大得多。

## 事件觸發器 {#event_triggers}

### 新用戶 — 完整流 {#new-user-full-flow}

下表介紹了沒有驗證令牌的用戶（新用戶或驗證令牌的用戶已過期）的事件和步驟：



![](assets/ae-flow-with-events.png)



該流涉及到MVPD的往返驗證(#5到\#7)和授權(\#11)。



流完成後，驗證和授權令牌將快取在用戶設備上。 驗證令牌的生存時間(TTL)值介於6小時到90天之間。 AuthN令牌過期將自動強制AuthZ令牌過期。 授權令牌的TTL值通常為24小時。

| 伺服器端事件觸發 | <ul><li>驗證嘗試、驗證掛起、已授予驗證</li><li>授權嘗試，授予授權</li><li>成功播放請求</li></ul> |
|---|---|


### 返回用戶 — 快取的AuthZ和AuthN令牌

對於快取了有效AuthZ和AuthN令牌的用戶，將執行以下步驟：


![](assets/ae-flow-tokens-cached-web.png)



調用時自動觸發 `getAuthorization()`，並且僅涉及使用Adobe Primetime身份驗證的檢查。 MVPD未參與此流。


| 伺服器端事件觸發 | *成功播放請求 |
|---|---|


### 返回用戶 — 快取的AuthN令牌，AuthZ令牌已過期

對於仍具有有效AuthN令牌的用戶，將執行以下步驟：

![](assets/ae-flow-authn-token-cached.png)


此流涉及到MVPD的往返。


| 伺服器端事件觸發 | <ul><li>授權嘗試，授權確定</li><li>成功播放請求</li> |
|---|---|

## 身份驗證事件 {#authn_events}

### 身份驗證嘗試 {#authentication-attempt}

如上圖所示，只有當用戶進行MVPD的往返時，才會觸發驗證事件；身份驗證事件不包括快取的令牌身份驗證。

在用戶從選取器按一下特定MVPD後觸發驗證嘗試事件。

* MVPD端上與此接近的第一個事件是頁面載入
* Adobe Primetime身份驗證不計入用戶在MVPD頁上重複登錄的嘗試（密碼不正確，請重試）
* 多次嘗試被計為一次嘗試
* 某些MVPD還在「驗證」步驟中執行「授權」，如果授權失敗，則不會重定向用戶。

### 驗證掛起 {#authentication-pending}

當向Adobe Primetime身份驗證的重定向過程啟動時，將發生此事件。

### 已授予身份驗證 {#authentication-granted}

用戶是MVPD的已知訂戶，通常具有付費電視訂閱，但有時只能訪問Internet。 成功驗證可能是因為用戶使用其MVPD明確輸入了有效憑據，或是因為他們以前輸入了有效憑據並選中了「記住我」（而上一會話尚未過期）。

因此，MVPD向Adobe Primetime驗證發送對驗證請求的正向響應，而Adobe Primetime驗證建立 *AuthN標籤*。

* 身份驗證通常快取很長時間（一個月或更長時間）。 因此，在令牌過期並重新啟動流之前，身份驗證事件將不再存在。
* 通過單一登錄從其他站點/應用進入將不會觸發身份驗證事件。

 

### Comcast身份驗證 {#comcast-authentication}

與其餘MVPD相比，Comcast具有不同的AuthN流。

以下功能描述了不同之處：

* **會話cookie行為**:這將導致用戶關閉瀏覽器後完全刪除任何驗證令牌。 此功能僅存在於Web上。 主要目的是確保您的Comcast會話不會在不安全/共用電腦上持續。 其影響是，與其餘MVPD相比，將有更多的驗證嘗試/授權流。

* **每個請求者ID的AuthN**:Comcast不允許將AuthN狀態從一個請求者ID快取到另一個請求者ID。 因此，每個站點/app必須轉到Comcast才能獲取身份驗證令牌。 除用戶體驗考慮外，如上所述，影響是將生成更多驗證嘗試/授予的事件。

* **被動身份驗證**:為了改善用戶體驗，但仍然保持每個請求者ID的AuthN功能，在隱藏的iFrame中發生被動驗證流。 用戶將看不到任何內容，但事件仍將像以前一樣被觸發。

如果用戶在Comcast登錄頁上按一下「記住我」，則隨後訪問此頁面（在2週內）將只是快速重定向回來。 否則，用戶實際上必須在頁面上進行身份驗證。

### 驗證失敗 {#unsuccessful-authentication}

不成功的身份驗證不是Adobe Primetime身份驗證中的事件本身，但可以計算為嘗試與成功之間的差異。

在2013年5月發佈的版本中，Adobe Primetime認證將為由於系統或網路錯誤而失敗的身份驗證添加錯誤代碼，包括DRM錯誤（令牌綁定失敗）和LSO錯誤（沒有空間寫入令牌等）。

### 驗證轉換率 {#authenitication-conversion-rate}

程式設計師可以跟蹤的一個有趣的度量是身份驗證轉換率，計算方式為（AuthN請求/AuthN已授予）%。

有關度量的一些說明：

* 由於它是基於事件的度量，因此它並不真正反映唯一的用戶轉換率 — 如果用戶嘗試八次，並在第九次之後成功 — 這將嚴重反映上述轉換率。
* 在Adobe Primetime身份驗證（在伺服器端）中，尚無法計算基於唯一的身份驗證轉換。
* 如果站點/應用中存在自動AuthN重試，這也會使上述度量傾斜。

## 授權事件 {#authorization_events}

### 授權嘗試 {#authorization_attempt}

除了獲得身份驗證令牌外，用戶還必須在播放內容之前獲得授權令牌。 這通常在身份驗證後或授權令牌過期時發生。 由於此檢查是在伺服器端(從Adobe Primetime驗證伺服器到MVPD伺服器)完成的，因此用戶無需執行任何操作。

### 授權 {#authorization-granted}

「授權授權」表示經認證的用戶的訂閱包括所請求的寫程式。

請注意，並非所有MVPD都支援單獨的授權步驟；因為某些驗證與授權相等。 MVPD向Adobe Primetime身份驗證發送對後通道AuthZ請求的成功響應，而Adobe Primetime身份驗證建立AuthZ令牌。

* AuthZ令牌被快取一段時間，通常為24小時。在此期間不會觸發AuthZ事件。
* 一些MVPD與資產級授權協作，其他MVPD與渠道級授權協作； — 根據使用的事件，觸發的AuthZ事件數或數目會更少。 即使對於通道級授權，快取也就位了 — 因此，如果在24小時內請求同一資產，則不會觸發任何事件。

### 拒絕授權 {#authorization-denied}

如果拒絕授權，則經過驗證的用戶沒有對所請求的寫程式的確認的預訂。 最可能的原因是該頻道不是用戶訂閱包的一部分，但這也可能反映用戶只能通過MVPD訪問Internet。

對於某些MVPD，即使用戶只有來自MVPD的Internet訂閱（無付費電視訂閱），用戶仍會成功進行身份驗證。 在這種情況下，即使用戶請求授權的通道在基本包中，也會拒絕授權。

某些MVPD為AuthZ拒絕提供自定義錯誤消息，其中可能包括升級其包的優惠。


### 授權轉換率 {#authorization-conversion-rate}

驗證轉換速率可以計算為（AuthZ請求/已授予AuthZ）%。

### 成功播放請求 {#successful-play-request}

同時經過驗證和授權的用戶被允許查看受保護的內容。

在成功的播放請求後，Adobe Primetime認證產生短命的媒體令牌，該媒體令牌斷言用戶有權觀看所請求的視頻。 程式設計師使用此媒體令牌進一步驗證預期查看器。 媒體令牌被跟蹤為成功的播放請求。

* Adobe Primetime驗證 *不* 跟蹤視頻播放是否在生成媒體令牌後真正開始。 例如，如果內容存在地域限制，則事務仍算作成功的播放請求，即使流實際上從未啟動。
* 由於AuthN和AuthZ令牌在一段時間內快取MVPD響應，因此成功的播放請求事件是度量中最頻繁的事件。

## 唯一用戶 {#unique-users}

### 定義 {#definition}

成功驗證後，Adobe Primetime驗證會根據返回的MVPD用戶ID值跟蹤唯一用戶的存在。  此值基於用戶的登錄資訊，但不包含可個人識別的資訊。

此值也會傳遞到sendTrackingData回調中的站點/應用。

此值可以跨設備持久（MVPD為給定用戶生成相同的值，無論登錄發生在何處）或暫時(對於每個登錄，都會生成新值，MVPD在其後端映射該值。 通常，MVPD提供給Adobe Primetime驗證的值在會話和設備之間是持久的，但如前所述，持久性既不保證也不驗證。

此值用作計算唯一用戶的方法。 針對特定間隔對報告的值（每個請求者ID/間隔/MVPD）進行重複資料消除。 因此，每天唯一用戶的總和通常不同於月值，而月值具有較低的值。

此數字包括來自Adobe Primetime身份驗證的所有事件，減去身份驗證嘗試（沒有用戶ID），但包括嘗試（可能失敗）的授權。

### 示例 {#examples}

#### 第1天 {#day1}

用戶XYZ將到站點觀看視頻。

觸發的事件：

* AuthN嘗試（尚無唯一用戶）
* 已授予AuthN
   * 此時，我們將根據MVPD返回的內容唯一地標識用戶 — 因此每日唯一用戶數增加1
   * AuthN令牌快取30天
* AuthZ嘗試/授予的事件
   * 快取1天的AuthZ令牌
* 成功播放請求事件

#### 第1天（稍後） {#day1-later-on}

用戶XYZ監視另一個視頻。

觸發的事件：

* 成功播放請求事件（其餘內容已快取）
* 每日或每月單位不增加

#### 第3天 {#day3}

用戶XYZ監視另一個視頻。

觸發的事件：

* AuthZ嘗試/授予的事件
   * 自第1天開始的1天快取已過期
* 成功播放請求事件（其餘內容已快取）
* 每日唯一用戶增加1 — 每月唯一用戶仍為1

#### 第31天 {#day31}

用戶XYZ監視另一個視頻。

與AuthN快取過期後的第1天相同。

如果同一用戶未通過授權，則每月唯一用戶數仍將增加1，因為有兩個事件包含用戶ID — 授予的身份驗證和授權嘗試。

### 單點登錄(SSO) {#single-sign-on-sso}

在某些情況下，唯一用戶的數量可能大於成功身份驗證的數量。 通常，當許多用戶通過SSO從其他站點/應用程式進入時，只需在當前站點/應用上獲得授權。

### 比較客戶端和伺服器端唯一用戶 {#comparing-client-side-and-server-side-unique-users}

如果用戶ID值來自 `sendTrackingData()` 在客戶端上用於計數唯一用戶，則客戶端和伺服器端號碼應匹配。

如果差異很大，則以下原因通常會導致差異：

* 視頻播放單元與所有事件單元。 如前所述，除AuthN嘗試外，Adobe Primetime身份驗證對所有事件計數唯一用戶。 這意味著，如果用戶僅驗證（在頁面上）但未查看視頻，則仍會觸發唯一的用戶計數增加。

* 計數未通過授權的用戶 — Adobe Primetime身份驗證將計算這些用戶以及報告的數字。

<!--
## Related Information {#related-information}

- [Entitlement Service Monitoring API](/help/authentication/entitlement-service-monitoring-api.md)

-->
